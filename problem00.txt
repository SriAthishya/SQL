/*1.EMPLOYEE WITH THE TOP THREE SALARIES*/
SELECT E_ID,NAME,SALARY FROM EMPLOYEE ORDER BY SALARY DESC LIMIT 3;
/*2.EMPLOYEE WITH THE LEAST SALARY*/
SELECT E_ID,NAME,SALARY FROM EMPLOYEE WHERE SALARY=(SELECT MIN(SALARY) FROM EMPLOYEE);
/*3.EMPLOYEES WHO DOES NOT HAVE A MANAGER IN THE DEPARTMENT TABLE*/
SELECT E_ID,NAME FROM EMPLOYEE E WHERE MANAGER_ID NOT IN (
SELECT E_ID FROM EMPLOYEE E JOIN DEPT D ON E.NAME=D.DEP_MANAGER);
/*4.EMPLOYEES WHO IS ALSO A MANAGER*/
SELECT E_ID,NAME FROM EMPLOYEE E WHERE E_ID IN (
SELECT E_ID FROM EMPLOYEE E JOIN DEPT D ON E.NAME=D.DEP_MANAGER);
/*5.EMPLOYEE WHO IS A MANAGER AND HAS LEAST SALARY*/
SELECT E_ID,NAME,salary FROM EMPLOYEE E WHERE e_id in (
SELECT E_ID FROM EMPLOYEE E JOIN DEPT D ON E.NAME=D.DEP_MANAGER) order by salary asc limit 1;
/*6.Total number of employees in communication department*/
select count(dep_id) from employee where dep_id='D02';
/*7.employee in finance dept who has the top salary*/
select e_id,name from employee where dep_id='D05' and salary in 
(select max(salary) from employee group by dep_id);
/*8.employee in product dept who has least salary*/
select e_id,name from employee where dep_id='D03' and salary in 
(select min(salary) from employee group by dep_id);
/*9.Count of employees in health with maximum salary*/
select count(e_id) from employee where dep_id='D01' and salary=
(select max(salary) from employee group by dep_id);
/*10.employees who report to Natasha Stevens*/
select e_id,name from employee where manager_id='A165';
/*11.Employee name,Employee count,Dep name,Dept manager in the Health department*/
select e.name,e_id employee_count,d.dep_name,d.dep_manager from employee e join dept d 
on d.dep_id=e.dep_id where e.dep_id='D01';
/*12.Department id,Employee ids and Manager ids for the Communications department*/
select dep_id,e_id,manager_id from employee where dep_id='D02';
/*13. Average Expenses for Each dept with Dept id and Dept name*/
select d.dep_id,d.dep_name,avg(e.salary) average_expenses from dept d join employee e 
on d.dep_id=e.dep_id group by d.dep_id;
/*14.total expense for the department finance*/
select sum(salary) total_expense,dep_id  from employee where dep_id='D05';
/*15.department which spends the least with Dept id and Dept manager name*/
select d.dep_id,d.dep_manager,avg(e.salary) expense from dept d join employee e on d.dep_id=e.dep_id 
group by d.dep_id order by salary desc limit 1;
/*16.count of Employees in each department*/
select count(e_id) no_of_emp,dep_id from employee group by dep_id;
/*17.count of Employees in each department having salary <20000*/
select dep_id,count(e_id) no_of_emp from employee where salary<20000 group by dep_id;
/*18. total number of Employees in Dept id D04 */
select count(e_id) no_of_emp from employee where dep_id='D04';
/*19.department details of the Department with Maximum Employees*/
select d.dep_id,d.dep_name,count(e.e_id) no_of_emp from employee e join dept d on d.dep_id=e.dep_id 
group by d.dep_id order by count(e.e_id) desc;
/*20.Employees who has Tim Archer as their manager*/
SELECT E_ID,NAME FROM EMPLOYEE WHERE MANAGER_ID IN
(select e.e_id from employee e join dept d on d.dep_manager=e.name where e.name='TIM ARCHER');

SELECT * FROM DEPT;
SELECT * FROM EMPLOYEE;